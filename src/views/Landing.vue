<template>
  <div class="main-frame">
    <div class="heading">
      <img src="../assets/images/Logo.png" alt="">
      <div id="sapiensbook-svg">
        <svg id="svgRef" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 68.34 10.33"><g><path id="svg-text" class="cls-1" d="M6.33,10.21l.78-1.08a3.76,3.76,0,0,0,1.11.8,3.22,3.22,0,0,0,1.43.31,1.89,1.89,0,0,0,1.2-.32,1,1,0,0,0,.41-.78.76.76,0,0,0-.16-.47,1.37,1.37,0,0,0-.44-.33A4.88,4.88,0,0,0,10,8.12l-.73-.2L8.54,7.7a3.65,3.65,0,0,1-.74-.28A2.81,2.81,0,0,1,7.18,7a1.6,1.6,0,0,1-.43-.61,2,2,0,0,1-.16-.84A2.07,2.07,0,0,1,7.4,3.88a3.22,3.22,0,0,1,2.1-.67,4.14,4.14,0,0,1,3,1.11l-.8,1a3.08,3.08,0,0,0-1.06-.69,3.65,3.65,0,0,0-1.26-.23,1.66,1.66,0,0,0-1,.27A.87.87,0,0,0,8,5.45a.6.6,0,0,0,.16.42,1,1,0,0,0,.42.29,5.51,5.51,0,0,0,.62.22l.74.21.77.21a4.78,4.78,0,0,1,.74.3,3.67,3.67,0,0,1,.63.43,1.9,1.9,0,0,1,.43.63A2.35,2.35,0,0,1,12,10.74a2.55,2.55,0,0,1-1,.54,4.52,4.52,0,0,1-1.39.2A4.26,4.26,0,0,1,6.33,10.21Z" transform="translate(-6.33 -3.21)"/><path class="cls-1" d="M13.59,9.55a2,2,0,0,1,.18-.86,1.64,1.64,0,0,1,.47-.59,2,2,0,0,1,.65-.33,2.12,2.12,0,0,1,.71-.12,2.32,2.32,0,0,1,1.87.76V7.56a.94.94,0,0,0-.37-.79,1.58,1.58,0,0,0-1-.29,2.44,2.44,0,0,0-1.72.71l-.51-.86a3.42,3.42,0,0,1,2.43-.94,3.38,3.38,0,0,1,.93.12,2.29,2.29,0,0,1,.76.35,1.64,1.64,0,0,1,.53.65,2.33,2.33,0,0,1,.19,1v3.83H17.47V10.7a2.27,2.27,0,0,1-.81.58,2.82,2.82,0,0,1-1.06.2,2.16,2.16,0,0,1-.71-.12,2.44,2.44,0,0,1-.65-.36,1.72,1.72,0,0,1-.47-.61A1.92,1.92,0,0,1,13.59,9.55Zm1.26,0a.9.9,0,0,0,.35.74,1.38,1.38,0,0,0,.89.29,2.08,2.08,0,0,0,.8-.16,1.3,1.3,0,0,0,.58-.44V9.13a1.38,1.38,0,0,0-.58-.44,2.07,2.07,0,0,0-.8-.15,1.37,1.37,0,0,0-.89.28A.93.93,0,0,0,14.85,9.57Z" transform="translate(-6.33 -3.21)"/><path class="cls-1" d="M20.37,13.54v-8h1.26v.79a2.45,2.45,0,0,1,.81-.69,2.39,2.39,0,0,1,1-.25,2.32,2.32,0,0,1,1.86.82,3.27,3.27,0,0,1,.71,2.22,3.31,3.31,0,0,1-.71,2.23,2.35,2.35,0,0,1-1.86.82,2.26,2.26,0,0,1-1-.24,2.44,2.44,0,0,1-.83-.71v3Zm1.26-4a1.63,1.63,0,0,0,.63.55,1.85,1.85,0,0,0,.86.23,1.46,1.46,0,0,0,1.18-.54,2.09,2.09,0,0,0,.45-1.39,2,2,0,0,0-.45-1.38,1.46,1.46,0,0,0-1.18-.54,1.82,1.82,0,0,0-.86.23,1.63,1.63,0,0,0-.63.55Z" transform="translate(-6.33 -3.21)"/><path class="cls-1" d="M27.38,4.6a.71.71,0,0,1-.23-.55.73.73,0,0,1,.23-.55.76.76,0,0,1,.55-.23.75.75,0,0,1,.55.23.76.76,0,0,1,.23.55.79.79,0,0,1-.78.78A.76.76,0,0,1,27.38,4.6Zm-.08,6.73V5.54h1.26v5.79Z" transform="translate(-6.33 -3.21)"/><path class="cls-1" d="M29.83,8.43A3.15,3.15,0,0,1,30.2,6.9a2.85,2.85,0,0,1,1.05-1.1,2.9,2.9,0,0,1,1.51-.41,2.63,2.63,0,0,1,2.07.89,3.31,3.31,0,0,1,.78,2.27v.3H31.14A1.78,1.78,0,0,0,31.7,10a1.8,1.8,0,0,0,1.29.46,2.6,2.6,0,0,0,.89-.17,2,2,0,0,0,.75-.47l.57.83a2.81,2.81,0,0,1-1,.62,3.79,3.79,0,0,1-1.31.22,2.93,2.93,0,0,1-3-3.05ZM31.13,8H34.4a2,2,0,0,0-.11-.53A1.91,1.91,0,0,0,34,6.94a1.27,1.27,0,0,0-.51-.38,1.83,1.83,0,0,0-.73-.14,1.75,1.75,0,0,0-.7.14,1.28,1.28,0,0,0-.5.37,1.8,1.8,0,0,0-.3.49A1.77,1.77,0,0,0,31.13,8Z" transform="translate(-6.33 -3.21)"/><path class="cls-1" d="M36.87,11.33V5.54h1.26v.79A2.77,2.77,0,0,1,39,5.67a2.48,2.48,0,0,1,1.18-.28,1.9,1.9,0,0,1,1.4.48A1.92,1.92,0,0,1,42,7.26v4.07H40.78V7.71a1.21,1.21,0,0,0-.3-.92,1.2,1.2,0,0,0-.86-.28,1.73,1.73,0,0,0-.86.23,1.79,1.79,0,0,0-.63.55v4Z" transform="translate(-6.33 -3.21)"/><path class="cls-1" d="M43.17,10.58l.58-.92a2.87,2.87,0,0,0,.87.58,2.72,2.72,0,0,0,1.09.24,1.46,1.46,0,0,0,.85-.21.7.7,0,0,0,.29-.57.46.46,0,0,0-.19-.38,1.55,1.55,0,0,0-.5-.24l-.68-.17-.75-.2A3,3,0,0,1,44,8.43a1.41,1.41,0,0,1-.5-.5,1.5,1.5,0,0,1-.19-.78A1.55,1.55,0,0,1,44,5.9a2.51,2.51,0,0,1,1.67-.51,3.29,3.29,0,0,1,2.25.81l-.52.89a2,2,0,0,0-.73-.51,2.53,2.53,0,0,0-1-.19,1.34,1.34,0,0,0-.79.2.6.6,0,0,0-.29.51.4.4,0,0,0,.15.31,1.06,1.06,0,0,0,.4.19l.57.14.64.15a4.83,4.83,0,0,1,.64.22,3.31,3.31,0,0,1,.56.33,1.34,1.34,0,0,1,.4.5,1.7,1.7,0,0,1,.14.73,1.6,1.6,0,0,1-.63,1.3,2.79,2.79,0,0,1-1.78.51,4.18,4.18,0,0,1-1.39-.23A3,3,0,0,1,43.17,10.58Z" transform="translate(-6.33 -3.21)"/><path class="cls-1" d="M49.55,11.33v-8h.36v3.2a2.59,2.59,0,0,1,.91-.83A2.29,2.29,0,0,1,52,5.39a2.33,2.33,0,0,1,1.87.84,3.27,3.27,0,0,1,.72,2.21,3.31,3.31,0,0,1-.71,2.21,2.37,2.37,0,0,1-1.88.83,2.4,2.4,0,0,1-1.21-.32,2.62,2.62,0,0,1-.88-.8v1ZM49.91,10a2.27,2.27,0,0,0,.86.82,2.41,2.41,0,0,0,1.23.33,1.92,1.92,0,0,0,1.61-.76,3.12,3.12,0,0,0,.58-2,3.12,3.12,0,0,0-.58-1.95A1.92,1.92,0,0,0,52,5.72a2.38,2.38,0,0,0-1.23.34,2.45,2.45,0,0,0-.86.83Z" transform="translate(-6.33 -3.21)"/><path class="cls-1" d="M56.36,10A3.54,3.54,0,0,1,56,8.43a3.51,3.51,0,0,1,.33-1.54,2.65,2.65,0,0,1,1-1.09A2.62,2.62,0,0,1,61.1,6.89a3.48,3.48,0,0,1,.32,1.54A3.51,3.51,0,0,1,61.1,10a2.63,2.63,0,0,1-3.79,1.1A2.68,2.68,0,0,1,56.36,10Zm.06-1.54a3.43,3.43,0,0,0,.26,1.33,2.46,2.46,0,0,0,.8,1,2.09,2.09,0,0,0,1.25.39,2.11,2.11,0,0,0,1-.22,2.08,2.08,0,0,0,.73-.61,2.74,2.74,0,0,0,.44-.87,3.54,3.54,0,0,0,0-2,2.8,2.8,0,0,0-.44-.86,2.05,2.05,0,0,0-.73-.6,2.11,2.11,0,0,0-1-.23,2.09,2.09,0,0,0-1.25.39,2.43,2.43,0,0,0-.8,1A3.43,3.43,0,0,0,56.42,8.43Z" transform="translate(-6.33 -3.21)"/><path class="cls-1" d="M63.2,10a3.54,3.54,0,0,1-.33-1.54,3.51,3.51,0,0,1,.33-1.54,2.58,2.58,0,0,1,1-1.09A2.66,2.66,0,0,1,67,5.8a2.65,2.65,0,0,1,1,1.09,3.62,3.62,0,0,1,.32,1.54A3.66,3.66,0,0,1,67.94,10a2.62,2.62,0,0,1-1,1.1,2.66,2.66,0,0,1-2.84,0A2.61,2.61,0,0,1,63.2,10Zm.06-1.54a3.43,3.43,0,0,0,.26,1.33,2.38,2.38,0,0,0,.8,1,2.07,2.07,0,0,0,1.25.39,2.14,2.14,0,0,0,1-.22,2.08,2.08,0,0,0,.73-.61,2.74,2.74,0,0,0,.44-.87,3.54,3.54,0,0,0,0-2,2.8,2.8,0,0,0-.44-.86,2.05,2.05,0,0,0-.73-.6,2.14,2.14,0,0,0-1-.23,2.07,2.07,0,0,0-1.25.39,2.35,2.35,0,0,0-.8,1A3.43,3.43,0,0,0,63.26,8.43Z" transform="translate(-6.33 -3.21)"/><path class="cls-1" d="M70,11.33v-8h.37V9.07l3.78-3.53h.51L71.85,8.15l2.79,3.18h-.52L71.57,8.42l-1.19,1.1v1.81Z" transform="translate(-6.33 -3.21)"/></g></svg>
        <div class="circle-1"></div>
        <div class="circle-2"></div>
        <div class="circle-3"></div>
        <div class="circle-4"></div>
      </div>
      <span class="subtitle">The social network for reasearchers</span>
      <div class="button-box">
        <a href="#login" class="btn btn--landing" id="toLogin" 
          @click="activeLogin = true, activeSignin = false">Log in</a>
        <a href="#signin" class="btn btn--landing" id="toSignin" 
          @click="activeLogin = false, activeSignin = true">Sign in</a>
      </div>
      <div class="btn--icon-circle"
        @click="disabledCard = !disabledCard">
        <svg class="material-icon" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"/></svg>
      </div>

      <div class="help-card"
        :class="{'help-card--disabled': disabledCard}">
        <div class="help-card__close"
          @click="disabledCard = true">
          <svg class="material-icon" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </div>
        Lorem ipsum dolor sit amet consectetur adipisicing elit. Officiis nisi labore saepe repudiandae odio officia.
      </div>

      <div class="login-box" id="login" 
        v-show="activeLogin"
        @keypress.enter="userLogin">
        <div class="input-box">
          <div class="input__label">Email</div>
          <input 
            type="text" 
            v-model="login.email"
            class="input--landing">
        </div>
        <div class="input-box">
          <div class="input__label">Password</div>
          <input 
            type="password" 
            v-model="login.password"
            class="input--landing">
        </div>
        <div style="text-align: right">
          <div class="btn btn--landing" @click="userLogin">
            Enter
          </div>
        </div>
      </div>

      <div class="signin-box" id="signin" v-show="activeSignin">
        <div class="input-box">
          <div class="input__label">Name</div>
          <input 
            type="text" 
            v-model="signin.name"
            class="input--landing">
        </div>

        <div class="input-box">
          <div class="input__label">Lastname</div>
          <input 
            type="text" 
            v-model="signin.lastname"
            class="input--landing">
        </div>

        <div class="input-box">
          <div class="input__label">Password</div>
          <input 
            type="password" 
            v-model="signin.password"
            class="input--landing">
        </div>

        <div class="input-box">
          <div class="input__label">Email</div>
          <input 
            type="email" 
            v-model="signin.email"
            class="input--landing">
        </div>
        
        <div class="input-box">
          <div class="input__label">Study areas</div>
          <input 
            type="text" 
            v-model="signin.study_areas"
            class="input--landing">
        </div>

        <div class="input-box">
          <div class="input__label">Organization</div>
          <input 
            type="text" 
            v-model="signin.organization"
            class="input--landing">
        </div>

        <div class="input-box">
          <div class="input__label">Profile</div>
          <input 
            type="text" 
            v-model="signin.profile"
            class="input--landing">
        </div>

        <div class="input-box">
          <div class="input__label">Nationality</div>
          <input 
            type="text" 
            v-model="signin.nationality"
            class="input--landing">
        </div>

        <div class="input-box">
          <div class="input__label">Gender</div>
          <input 
            type="text" 
            v-model="signin.gender"
            class="input--landing">
        </div>

        <div class="input-box">
          <div class="input__label">Languages</div>
          <input 
            type="text" 
            v-model="signin.languages"
            class="input--landing">
        </div>

        <div class="input-box">
          <div class="input__label">Skills</div>
          <input 
            type="text" 
            v-model="signin.skills"
            class="input--landing">
        </div>

        <div class="input-box">
          <div class="input__label">Publications</div>
          <input 
            type="text" 
            v-model="signin.publications"
            class="input--landing">
        </div>

        <div style="text-align: right; width: 100%: padding: 15px 0">
          <div class="btn btn--landing" @click="userSignin">
            Sing up
          </div>
        </div>

      </div>41

    </div>

  </div>  
</template>

<script>
import GQL from '../http_common'
import jwt from 'jsonwebtoken'

export default {
  data() {
    return {
      disabledCard: true,
      activeLogin: false,
      activeSignin: false,
      login: {
        email: '',
        password: ''
      },
      signin: {
        name: '',
        lastname: '',
        email: '',
        password: '',
        study_areas: '',
        organization: '',
        nationality: '',
        gender: '',
        languages: '',
        skills: '',
        publications: '',
      }
    }
  },
  methods: {
    async userLogin() {
      try {
        const res = await GQL.post('', {
          query: `
            mutation Login($data: loginInput!) {
              login(data: $data) 
            }`,
          variables: {
            data: {
              email: "daerod@gmail.com",
              password: "Daniel123"
            }
            // data: {
            //   email: this.login.email,
            //   password: this.login.password
            // }
          }
        })
  
        console.log(res)
        let token = res.data.data.login;
        this.$store.commit('setJwt', token);
        this.$store.commit('setCurrentUser', jwt.decode(token)._id)
        this.$router.push({name: 'UserMe'})

      } catch (e) {
        console.log(e)
      }
    },
    async userSignin() {
      try {
        const res = await GQL.post('', {
          query: `
            mutation CreateUser($user: UserInput!) {
              createUser(user: $user) {
                name
                _id
              }
            }`,
            variables: {
              user: {
                name: "Daniel",
                lastname: "Rodriguez",
                email: this.signin.email,
                password: 'Daniel123',
                organization: 'asda',
                nationality: 'asdasdasdasd',
                // gender: 'Male',
                languages: ['asdasdasdasd'],
                skills: ['asdasdasdasd'],
              }
            }
        })

        console.log(res)
        
      } catch(e) {
        console.log(e)
      }
    }
  },
  mounted() {
    let path = document.getElementById('svg-text')
    let pathLength = Math.ceil(path.getTotalLength());
    console.log(pathLength)

    let svgRef = document.getElementById('svgRef')

    Object.assign(path.style, {
      'stroke-dasharray': pathLength,
      'stroke-dashoffset': pathLength,
      'animation': 'dash 5s linear forwards' 
    })
    
    let anchor = document.getElementById("toLogin")
    anchor.addEventListener('click', function (e) {
        e.preventDefault();

        document.querySelector(this.getAttribute('href')).scrollIntoView({
            behavior: 'smooth'
        });
    });

    anchor = document.getElementById("toSignin")
    anchor.addEventListener('click', function (e) {
        e.preventDefault();

        document.querySelector(this.getAttribute('href')).scrollIntoView({
            behavior: 'smooth'
        });
    });
  }
}
</script>

<style lang="sass" scoped>
@import '../stylesheets/general.sass'

.main-frame
  width: 100vw
  height: 100vh
  position: relative
  background: linear-gradient(to bottom, rgba(42, 39, 100, 1) 0%, rgba(47, 38, 91, 1) 70%, rgba(43, 36, 78, 1) 100%)
  overflow-y: scroll
  overflow-x: hidden

.heading
  z-index: 2
  position: absolute
  +flex(1, 1)
  flex-direction: column
  top: 20%
  left: 50%
  transform: translateX(-50%)
  color: #C89A4F

  > *
    position: relative
    animation: 1.5s fadeInJump forwards cubic-bezier(.44,.41,.24,1.34)

  #sapiensbook-svg
    position: relative
    margin-top: 25px 
    width: 300px
    fill: #C89A4F

  img
    width: 150px

  .subtitle
    padding: 7px 0

.button-box
  padding: 80px 0
  .btn
    margin: 0 20px

// name duration timing-function delay iteration-count direction fill-mode play-state
@for $i from 1 through 4
  .#{circle}-#{$i}
    opacity: 0
    width: 30vw * $i
    height: 30vw * $i
    min-width: 440px * $i
    min-height: 440px * $i
    z-index: -1
    position: absolute
    top: -40%
    left: 50%
    transform: translate(-50%, -50%) 
    background: linear-gradient(to bottom, rgba(255,255,255,.2) 0%,  rgba(255,255,255, .02) 100%)
    background: rgba(white, .018)
    border-radius: 50%
    animation: pulse 1.5s ease-in-out (.5s * $i + 4 * .6s) infinite alternate, fadeIn 1.5s cubic-bezier(.44,.41,.24,1.34)  .6s * $i forwards 
    box-shadow: 0 1px 30px 5px rgba(black, .01)
a
  text-decoration: none
  color: inherit

.btn--landing
  border: 2px solid rgba(#C89A4F, .2)
  overflow: hidden
  position: relative
  background: linear-gradient(60deg, #392248 0%, #6d4089 100%)
  
  &:after
    content: ''
    position: absolute
    background: rgba(white, .5)
    transform: skewX(-15deg)
    filter: blur(25px)
    width: 30%
    height: 100%
    top: 0
    left: -60%

  &:hover:after
    left: 160%
    transition: .5s
    transition-delay: .3s ease-in

.login-box, .signin-box 
  border-radius: 4px
  +flex(0, 0)
  flex-direction: column
  padding: 30px
  border: 1px solid rgba(white, .1)
  background: rgba(#392248, .3)
  animation: fadeInJump 1s forwards
  position: relative
  margin-bottom: 30px

.signin-box
  justify-content: center
  max-width: 700px 
  flex-direction: row
  flex-wrap: wrap

@keyframes pulse
  0%
    transform: translate(-50%, -50%) scale(1)

  90% 
    transform: translate(-50%, -50%) scale(1.05)
  
  100% 
    transform: translate(-50%, -50%) scale(1.05)

@keyframes dash
  to
    stroke-dashoffset: 0

@keyframes fadeInJump
  from
    top: 70px
    opacity: 0

  to
    top: 0px
    opacity: 1

@keyframes fadeIn
  from
    opacity: 0

  to
    opacity: 1


</style>

